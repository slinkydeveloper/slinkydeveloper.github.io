<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#222">
  <link rel="manifest" href="/images/manifest.json">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script class="next-config" data-name="main" type="application/json">{"hostname":"slinkydeveloper.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.10.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

  <meta name="description" content="Today I&#39;m going to introduce you an idea Markus Thömmes and I had to package, deploy and operate Kubernetes controllers in a modern and efficient way that may have a fundamental impact on the Kubernet">
<meta property="og:type" content="article">
<meta property="og:title" content="Kubernetes Controllers - A new hope">
<meta property="og:url" content="https://slinkydeveloper.com/Kubernetes-controllers-A-New-Hope/index.html">
<meta property="og:site_name" content="Slinky&#39;s corner">
<meta property="og:description" content="Today I&#39;m going to introduce you an idea Markus Thömmes and I had to package, deploy and operate Kubernetes controllers in a modern and efficient way that may have a fundamental impact on the Kubernet">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://slinkydeveloper.com/images/kubernetes-controllers-a-new-hope/kubernetes-controllers-a-new-hope-1.png">
<meta property="og:image" content="https://slinkydeveloper.com/images/kubernetes-controllers-a-new-hope/kubernetes-controllers-a-new-hope-2.png">
<meta property="og:image" content="https://slinkydeveloper.com/images/kubernetes-controllers-a-new-hope/kubernetes-controllers-a-new-hope-3.png">
<meta property="og:image" content="https://slinkydeveloper.com/images/kubernetes-controllers-a-new-hope/kubernetes-controllers-a-new-hope-4.png">
<meta property="article:published_time" content="2020-07-28T16:42:13.000Z">
<meta property="article:modified_time" content="2023-08-28T15:56:42.185Z">
<meta property="article:author" content="Software Engineer">
<meta property="article:tag" content="cloud">
<meta property="article:tag" content="kubernetes">
<meta property="article:tag" content="rust">
<meta property="article:tag" content="webassembly">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://slinkydeveloper.com/images/kubernetes-controllers-a-new-hope/kubernetes-controllers-a-new-hope-1.png">


<link rel="canonical" href="https://slinkydeveloper.com/Kubernetes-controllers-A-New-Hope/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://slinkydeveloper.com/Kubernetes-controllers-A-New-Hope/","path":"Kubernetes-controllers-A-New-Hope/","title":"Kubernetes Controllers - A new hope"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Kubernetes Controllers - A new hope | Slinky's corner</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-39408029-2"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-39408029-2","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>




<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#252e39"
    },
    "button": {
      "background": "#14a7d0"
    }
  }
})});
</script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Slinky's corner" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Slinky's corner</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Random programming stuff</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Kubernetes-controllers-today"><span class="nav-number">2.</span> <span class="nav-text">Kubernetes controllers today</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Extending-Kubernetes-APIs-in-process"><span class="nav-number">3.</span> <span class="nav-text">Extending Kubernetes APIs in process</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Isolated-multi-language-lightweight-plugin-system-That-sounds-hard%E2%80%A6"><span class="nav-number">4.</span> <span class="nav-text">Isolated, multi-language, lightweight plugin system? That sounds hard…</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Show-me-your-ABI"><span class="nav-number">5.</span> <span class="nav-text">Show me your ABI!</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#WASI"><span class="nav-number">5.1.</span> <span class="nav-text">WASI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Designing-the-ABI"><span class="nav-number">5.2.</span> <span class="nav-text">Designing the ABI</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Our-prototype"><span class="nav-number">6.</span> <span class="nav-text">Our prototype</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-ABI"><span class="nav-number">6.1.</span> <span class="nav-text">The ABI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-controller"><span class="nav-number">6.2.</span> <span class="nav-text">The controller</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Next-steps"><span class="nav-number">6.3.</span> <span class="nav-text">Next steps</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Wait-where-is-Golang"><span class="nav-number">7.</span> <span class="nav-text">Wait, where is Golang?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#There-is-still-a-long-road-ahead"><span class="nav-number">8.</span> <span class="nav-text">There is still a long road ahead</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Software Engineer</p>
  <div class="site-description" itemprop="description">Personal blog of Francesco Guardiani, Software Engineer</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/slinkydeveloper" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;slinkydeveloper" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:me@slinkydeveloper.com" title="E-Mail → mailto:me@slinkydeveloper.com"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/francesco-guardiani" title="LinkedIn → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;francesco-guardiani" rel="noopener" target="_blank"><i class="linkedin fa-fw"></i>LinkedIn</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/2399055/francesco-guardiani" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;2399055&#x2F;francesco-guardiani" rel="noopener" target="_blank"><i class="stack-overflow fa-fw"></i>StackOverflow</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://slinkydeveloper.com/Kubernetes-controllers-A-New-Hope/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Software Engineer">
      <meta itemprop="description" content="Personal blog of Francesco Guardiani, Software Engineer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slinky's corner">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Kubernetes Controllers - A new hope
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 28-07-2020 18:42:13" itemprop="dateCreated datePublished" datetime="2020-07-28T18:42:13+02:00">28-07-2020</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 28-08-2023 17:56:42" itemprop="dateModified" datetime="2023-08-28T17:56:42+02:00">28-08-2023</time>
    </span>

  
</div>

            <div class="post-description">Today I'm going to introduce you an idea Markus Thömmes and I had to package, deploy and operate Kubernetes controllers in a modern and efficient way that may have a fundamental impact on the Kubernetes ecosystem.</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>Today I’m going to introduce you an idea <a target="_blank" rel="noopener" href="https://github.com/markusthoemmes/">Markus Thömmes</a> and I had to package, deploy and operate Kubernetes controllers in a modern and efficient way that may have a fundamental impact on the Kubernetes ecosystem.</p>
<h2 id="Introduction">Introduction</h2>
<p>Kubernetes is the standard de-facto container orchestration engine of these days. As every orchestrator of <em>“something”</em> (bare metal machines, VMs, containers, etc), one day you need to expand the available abstractions the system provides to you. For Kubernetes, that day came around 3 years ago where they introduced the concept of <a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Custom Resource</a>.</p>
<p>To put it simply, everything you create/read/update/delete in Kubernetes is an API Resource. A <strong>CRD</strong> (Custom Resource Definition) defines a new resource you can create/read/update/delete in your cluster, which is not included in the built-in ones, while a <strong>CR</strong> (Custom Resource) is an instance of the CRD. For example, a <code>Pod</code> is a Kubernetes resource from the <code>core</code> API group, a <code>Broker</code> is a CRD introduced when you install Knative Eventing on your Kubernetes cluster.<br>
With a definition of a new resource, you need to implement the business logic to orchestrate it, that is to handle create/read/update/delete operations on the resource. For example, you might want spawn a new <code>etcd</code> pod every time somebody creates a new <code>EtcdCluster</code> CR. In order to do that, you need to implement a Kubernetes controller: an application that listens for events on one or more API resources and reacts performing some operations on the cluster.</p>
<p>Since the introduction of CRDs, we’ve seen a <strong>huge</strong> expansion of extensions to Kubernetes APIs. Kubernetes vendors are using CRDs to provide distributions well integrated with their underlying systems, software vendors are developing controllers to simplify the operations on Kubernetes environment (for example <a target="_blank" rel="noopener" href="https://strimzi.io/">Strimzi</a> to deploy Kafka on Kubernetes), new projects are born to provide middleware and tooling to develop applications on top of Kubernetes (<a target="_blank" rel="noopener" href="https://knative.dev">Knative</a> to create serverless applications). Marketing around Kubernetes even forged a new name for the last use case: <em>Kubernetes native</em> applications, aka applications where the API-surface relies on the CRDs. In OpenShift there is even a <a target="_blank" rel="noopener" href="https://docs.openshift.com/container-platform/4.5/operators/understanding_olm/olm-understanding-olm.html">system</a>, based on a bunch of CRDs, to install other CRDs with their respective controllers.</p>
<div class="note "><p>Although there is a <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/47848258/kubernetes-controller-vs-kubernetes-operator">distinction</a> between controllers and operators, for the sake of simplicity in this post I’m going to always refer to <em>controller</em> as the entity that implements the business logic of a CRD.</p>
</div>
<p>This concept works pretty well for Kubernetes, although there are still some open questions about the controller itself. In this post I’m going to introduce you a solution <a target="_blank" rel="noopener" href="https://github.com/markusthoemmes/">Markus Thömmes</a> and I designed that may <strong>revolutionize</strong> how we package, deploy and operate Kubernetes controllers.</p>
<h2 id="Kubernetes-controllers-today">Kubernetes controllers today</h2>
<p>Today a Kubernetes controller consists of more or less:</p>
<ul>
<li>A main loop that does long polling to Kubernetes to watch one or more resources</li>
<li>On every event, a function called <em>reconciler</em> is invoked to align the cluster state to the desired state. For example: if the desired state expects a Pod to be running, but for some reason there isn’t, then the <em>reconciler</em> creates it.</li>
<li>The <em>reconciler</em> optionally set the status of the CR, like <em>Ready</em>, <em>SomeError</em>, …</li>
</ul>
<p>After we implement the controller, we need to configure and apply the <em>Custom Resource Definition</em> and we need to setup a <em>Service Account</em>, that is an account to connect to our Kubernetes cluster in order to perform the operations the <em>reconciler</em> does.</p>
<p>During the years a lot of tooling was created, <em>mostly in Golang</em>, to implement these controllers, depending on the user needs. To mention some of them:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/kubernetes-sigs/kubebuilder">Kubebuilder</a></li>
<li><a target="_blank" rel="noopener" href="https://sdk.operatorframework.io/">Operator SDK</a></li>
</ul>
<p>Other projects, like Knative, opt for creating and maintaining their <a target="_blank" rel="noopener" href="https://github.com/knative/pkg/tree/master/controller">own tooling</a> to implement controllers.</p>
<p>These tools usually provide:</p>
<ul>
<li>A library to improve the event handling logic: “smart” events queue that deduplicate and filter events for example</li>
<li>A code generator component that, starting from the CRD defined in the code, scaffolds the controller code and generates the client code to interact with the CRD</li>
</ul>
<p>In essence, all of these tools work the same though in that ultimately they will generate a binary containing the controller. Each binary can in theory contain a number of controllers, for example Knative’s framework actively encourages that with a <em>main</em> interface to start multiple controllers at same time. Crucially though, collapsing more than one controller into one binary and thus one process in the Kubernetes cluster needs to happen at <strong>compile time</strong>.<br>
With the systems commonly used, we’ll get <strong>at least one process</strong> (aka Pod) per project that extends Kubernetes (i.e. at least one Pod for Knative CRDs, at least one Pod for Strimzi CRDs etc.). Each of those processes will be mostly idle for most of their lifetime, but they will steadily consume resources nonetheless.<br>
In short: <strong>We’re flooding our Kubernetes clusters with applications that suck resources and remain in idle for most of their time!</strong></p>
<h2 id="Extending-Kubernetes-APIs-in-process">Extending Kubernetes APIs in process</h2>
<p>The idea behind our solution is to create a runtime plugin system where every plugin is a Kubernetes controller.</p>
<img src="/images/kubernetes-controllers-a-new-hope/kubernetes-controllers-a-new-hope-1.png" class="" title="Plugin system">
<p>This plugin system should have certain traits:</p>
<ul>
<li>Plugins should be well isolated between each other so no single plugin’s failure/bad behaviour can cause trouble in other plugins</li>
<li>The host should be able to control and restrict what the plugin can do</li>
<li>Users should be able to develop plugins with different languages</li>
<li>The host should be able to load and unload plugins at runtime, without restarting the system</li>
</ul>
<p>This plugin system can be seen as a <em>mega controller</em>. It can run as its own process, or it could even be merged with the <em>kube-controller-manager</em>, which is the process with all the controllers that manage the Kubernetes built-in resources:</p>
<img src="/images/kubernetes-controllers-a-new-hope/kubernetes-controllers-a-new-hope-2.png" class="" title="kube-controller-manager including the plugin system">
<h2 id="Isolated-multi-language-lightweight-plugin-system-That-sounds-hard…">Isolated, multi-language, lightweight plugin system? That sounds hard…</h2>
<p>The requirements of the plugin system are not trivial, but lucky for us WebAssembly (Wasm) comes in rescue!</p>
<p>Wasm is an instruction set, targetable from every programming language, that runs in an isolated Virtual Machine.</p>
<div class="note "><p>From <a target="_blank" rel="noopener" href="https://webassembly.org/">webassembly.org</a>: <em>“WebAssembly (abbreviated Wasm) is a binary instruction format for a stack-based virtual machine. Wasm is designed as a portable compilation target for programming languages, enabling deployment on the web for client and server applications”</em>.</p>
</div>
<p>That sounds like the perfect fit for our idea:</p>
<ul>
<li>Because it’s isolated by default, we define all the possible interactions between the plugins (controllers) and the host, piece by piece</li>
<li>Because it runs in a sandboxed virtual machine, it can easily isolate catastrophic failures and guarantee safe access to specific memory regions</li>
<li>Because it’s a general purpose instruction set, more similar to an ISA of a modern CPU other than the JVM bytecode, most languages can target it (GC-enabled, dynamic/static typed, …).</li>
</ul>
<p>A list of supported languages is available <a target="_blank" rel="noopener" href="https://webassembly.org/getting-started/developers-guide/">here</a> and <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/43540878/what-languages-can-be-compiled-to-webassembly-wasm">here</a>. Wasm is flexible enough that it can be executed with ahead of time (AOT) compilation or with a just in time (JIT) interpreter.</p>
<p>Although WebAssembly sounds like a web or browser technology, in the last years several people are experimenting with this technology <a target="_blank" rel="noopener" href="https://webassembly.org/docs/use-cases/#outside-the-browser">outside the browser</a>. Most notably, CloudFlare Function as a Service offering called Workers <a target="_blank" rel="noopener" href="https://blog.cloudflare.com/introducing-wrangler-cli/">uses Wasm</a> to run C/Rust code using Google’s V8 isolations.</p>
<p>With WebAssembly, our plugin system looks like:</p>
<img src="/images/kubernetes-controllers-a-new-hope/kubernetes-controllers-a-new-hope-3.png" class="">
<p>When we develop a controller, the compiled artifact is a binary Wasm module. A Wasm engine loads this module, eventually compiles it in AOT cases, and executes it.</p>
<p>At this point, we need to define the interaction semantics between the host and the plugins. In order to do that, we define the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Application_binary_interface">ABI (Application Binary Interface)</a> of our plugin system: the functions the host <em>imports</em> in our plugin and the functions the plugin <em>exports</em> in our host.</p>
<h2 id="Show-me-your-ABI">Show me your ABI!</h2>
<p>First of all, an example of a Wasm ABI. This is the Rust code for a Wasm module:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[link(wasm_import_module = <span class="string">&quot;my-abi&quot;</span>)]</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">println</span>(ptr: *<span class="keyword">const</span> <span class="type">u8</span>, len: <span class="type">usize</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[no_mangle]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="keyword">fn</span> <span class="title function_">foo</span>() &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>This Wasm module exports the function <code>foo</code>, which means that, after the module has been loaded, the engine can invoke <code>foo</code> to execute it. On the other side, when we load the module in the engine, we must link some logic to the function <code>println</code> in order to run it, otherwise we’ll get a link error.</p>
<p>We can get all imports and exports of a module using a tool called <a target="_blank" rel="noopener" href="https://github.com/fitzgen/wasm-nm"><code>wasm-nm</code></a>.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">% </span><span class="language-bash">wasm-nm module.wasm -i <span class="comment">#Get the imports</span></span></span><br><span class="line">i println</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">% </span><span class="language-bash">wasm-nm module.wasm -e <span class="comment">#Get the exports</span></span></span><br><span class="line">e foo</span><br></pre></td></tr></table></figure>
<p>This is the most important design choice of the project: the ABI influences the capabilities the host needs to implement, the portability of existing controllers, the APIs on the plugin side and so on. When we design the ABI we also need to take the differences of the programming languages into account: as an example, some may require additional interfaces to the host to run asynchronous code. The async schedulers in Rust and the goroutine scheduler in Golang both require a syscall to <code>sched_yield</code> to yield a thread execution in this example.</p>
<h3 id="WASI">WASI</h3>
<p>Lucky for us, part of the job that includes the <em>low-level</em> primitives is covered by a work in progress spec called <a target="_blank" rel="noopener" href="https://wasi.dev/">WASI (WebAssembly System Interface)</a>. Their goal is to provide a reduced set of POSIX-like APIs: read/write files, get system clock, get environment variables and program arguments, read/write a socket and so on. Although, as they state in their <a target="_blank" rel="noopener" href="https://github.com/bytecodealliance/wasmtime/blob/main/docs/WASI-rationale.md">rationale document</a>, it’s not goal of WASI to include primitives to <strong>open sockets/files</strong>, this is left to the users. From their docs:</p>
<div class="note "><p>One of WebAssembly’s unique attributes is the ability to run sandboxed without relying on OS process boundaries. Requiring a 1-to-1 correspondence between wasm instances and heavyweight OS processes would take away this key advantage for many use cases. Fork/exec are the obvious example of an API that’s difficult to implement well if you don’t have POSIX-style processes, but a lot of other things in POSIX are tied to processes too. So it isn’t a simple matter to take POSIX, or even a simple subset of it, to WebAssembly.</p>
</div>
<p>A socket is a process wide resource. This means that if module A opens a TCP socket, module B might have access to it if we don’t implement proper security countermeasures.</p>
<h3 id="Designing-the-ABI">Designing the ABI</h3>
<p>Given our knowledge and studies of the current state of art for Wasm ABIs, we found out there are 3 possible non mutually exclusive approaches to the ABI design:</p>
<ul>
<li><strong>High level ABI</strong>: Expose the Kubernetes client functionalities</li>
<li><strong>Medium level ABI</strong>: Proxy the HTTP client functionalities (send HTTP request, receive HTTP response)</li>
<li><strong>Low level ABI</strong>: Proxy the syscalls (<code>epoll</code>, <code>read</code>, <code>write</code>, <code>bind</code>, …)</li>
</ul>
<p>We think that a good solution should mix all these 3 <em>“levels”</em>. Some low-level APIs are always necessary for basic things like logging, getting configuration from environment, setting timeouts and so on.<br>
Proxying HTTP can be useful to invoke services outside Kubernetes (e.g. to trigger a cloud vendor API to enable a service).<br>
Exposing the Kubernetes client APIs unlocks a great potential to optimize the controllers beyond the optimized resource usage indicated above. Most prominently: the so called <em>informer</em> infrastructure can be shared between all the controllers. An informer is the part of a controller that listens for events on given resources. It builds up local caches that effectively reflect the state of said resources in-memory.<br>
In our case, the host would setup these informers and watches just <strong>once</strong> per resource. If two controllers want to watch <code>ConfigMap</code>s for example, the host would only need to setup one watch and keep one cache, reducing the amount of network traffic due to event delivery and memory consumption due to caching drastically. That effect becomes more and more pronounced as more extensions are being added.</p>
<p>Following the above approach, the host has always the full control of process resources (open files, open sockets, etc), we allow the modules to perform only certain operations and, most important, we open up for <strong>huge optimizations</strong>.</p>
<h2 id="Our-prototype">Our prototype</h2>
<p>Markus and I built a prototype of the host and of the 2 controllers, a simple pod spawner and the <a target="_blank" rel="noopener" href="https://sdk.operatorframework.io/docs/golang/quickstart/">Memcached example</a> from operator-sdk. You can find all the code here: <a target="_blank" rel="noopener" href="https://github.com/slinkydeveloper/extending-kubernetes-api-in-process-poc">https://github.com/slinkydeveloper/extending-kubernetes-api-in-process-poc</a></p>
<p>The host is implemented in Rust and <a target="_blank" rel="noopener" href="https://github.com/wasmerio/wasmer/">Wasmer</a>, a popular Wasm engine supporting different compilation backends and with several language bindings. We implemented the controllers with Rust using a hacked version of <a target="_blank" rel="noopener" href="https://github.com/clux/kube-rs"><code>kube-rs</code> client</a>.<br>
The host logic is pretty simple: when it starts, it reads the contents of the specified dir, looking for <code>.yaml</code> containing the module manifests. An example manifest:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">memcached</span></span><br><span class="line"><span class="attr">abi:</span> <span class="string">rust_v1alpha1</span></span><br></pre></td></tr></table></figure>
<p><code>name</code> is the operator name and <code>abi</code> is the abi the host should use to interact with the module. This allows to <a target="_blank" rel="noopener" href="https://github.com/slinkydeveloper/extending-kubernetes-api-in-process-poc/blob/ff4e07f2ca29ac7fd913cb3578749d64c25cb048/rust-host/src/abi/mod.rs#L19">support different ABIs</a> at the same time, mainly to overcome the differences between the programming languages and to support old modules running on new host versions.</p>
<p>Then, for each module, it compiles and runs it in a separate thread invoking the exported <code>run</code> function. The module, through the custom ABI we designed, can interact with Kubernetes to start watching resources and react to the events.</p>
<div class="note "><p>The prototype contains several simplifications that we can overcome easily (like watching the modules directory more than loading all the modules once), while others require more engineering as discussed later in this post.</p>
</div>
<h3 id="The-ABI">The ABI</h3>
<p>In order to create a running prototype, we ended up with a pretty simple ABI that mixes the low level WASI syscalls with a medium level HTTP client proxy functionality:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">% </span><span class="language-bash">wasm-nm memcached.wasm -i</span></span><br><span class="line">i request</span><br><span class="line">i clock_time_get</span><br><span class="line">i fd_write</span><br><span class="line">i poll_oneoff</span><br><span class="line">i random_get</span><br><span class="line">i proc_exit</span><br><span class="line">i environ_sizes_get</span><br><span class="line">i environ_get</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">% </span><span class="language-bash">wasm-nm memcached.wasm -e</span></span><br><span class="line">e run</span><br><span class="line">e allocate</span><br></pre></td></tr></table></figure>
<p>The exports are <code>run</code> to start the controller and <code>allocate</code> to allocate memory on the module. The implementer of the controller just implements the resources watch loop inside the <code>run</code> function.</p>
<div class="note info"><p>In Wasm the module cannot access to the host memory, but the host can access to the module memory and copy bytes inside it. Because the Wasm module might have a memory allocator, a GC or any other mechanism to manage memory, the module should export a function that allocates memory to let the host copy bytes back to the module.</p>
</div>
<p><code>request</code> is the function to perform a <strong>blocking and buffered</strong> HTTP request, while all the other imports come from WASI. The user interacts with our hacked version of the Kubernetes client, which under the hood invokes <code>request</code> to perform HTTP requests using <a target="_blank" rel="noopener" href="https://github.com/seanmonstar/reqwest"><code>reqwest</code> crate</a>. All our APIs are blocking because currently there is no out of the box <code>async/await</code> support in Wasm modules, I’ll cover this limitation later.</p>
<p>The <code>request</code> flow should give you an idea of what it takes to implement an ABI:</p>
<img src="/images/kubernetes-controllers-a-new-hope/kubernetes-controllers-a-new-hope-4.png" class="">
<p>The host takes care of handling the authentication, in order to avoid the controller having to have access to files at all.</p>
<h3 id="The-controller">The controller</h3>
<p>An example code for the controller looks like:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">client</span> = Client::<span class="title function_ invoke__">default</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">foos</span>: Api&lt;SimplePod&gt; = Api::<span class="title function_ invoke__">namespaced</span>(client.<span class="title function_ invoke__">clone</span>(), <span class="string">&quot;default&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">inform</span> = Informer::<span class="title function_ invoke__">new</span>(foos).<span class="title function_ invoke__">params</span>(ListParams::<span class="title function_ invoke__">default</span>().<span class="title function_ invoke__">timeout</span>(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">pods</span>: Api&lt;Pod&gt; = Api::<span class="title function_ invoke__">namespaced</span>(client.<span class="title function_ invoke__">clone</span>(), <span class="string">&quot;default&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">loop</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">events</span> = inform.<span class="title function_ invoke__">poll</span>().<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Poll error&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">e</span> <span class="keyword">in</span> events &#123;</span><br><span class="line">        <span class="keyword">match</span> e &#123;</span><br><span class="line">            <span class="title function_ invoke__">Ok</span>(WatchEvent::<span class="title function_ invoke__">Added</span>(o)) | <span class="title function_ invoke__">Ok</span>(WatchEvent::<span class="title function_ invoke__">Modified</span>(o)) =&gt; &#123;</span><br><span class="line">                <span class="title function_ invoke__">reconcile_pod</span>(&amp;pods, &amp;o.<span class="title function_ invoke__">name</span>(), &amp;o.spec.image).<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Reconcile error&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_ invoke__">Ok</span>(WatchEvent::<span class="title function_ invoke__">Error</span>(e)) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Error event: &#123;:?&#125;&quot;</span>, e),</span><br><span class="line">            <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Error event: &#123;:?&#125;&quot;</span>, e),</span><br><span class="line">            _ =&gt; &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>You can look at the full controller code for the above sample <a target="_blank" rel="noopener" href="https://github.com/slinkydeveloper/extending-kubernetes-api-in-process-poc/blob/master/ext-simple-pod/src/lib.rs">here</a>. The user potentially doesn’t know that their code is run inside an isolation. Everything is hidden behind the usual Kubernetes client APIs. In other words: <strong>The programming model does not change.</strong></p>
<h3 id="Next-steps">Next steps</h3>
<p>There are some things we still haven’t tested, but that we’re willing to do in order to give us a clear idea of how to grow this idea:</p>
<ul>
<li>Re-design the ABI to support unbuffered &amp; asynchronous HTTP requests. This requires several additions to both the Wasm engine and the host code, most notably the engine should have the ability to <a target="_blank" rel="noopener" href="https://github.com/wasmerio/wasmer/issues/1127">yield the execution</a> and the module should have an <a target="_blank" rel="noopener" href="https://rust-lang.github.io/async-book/02_execution/04_executor.html">async executor</a> to execute async operations.</li>
<li>The proposed ABI mixes medium level and low level. We want to try to implement a high level function in our ABI for watching Kubernetes resources, in order to register a single watch for all the controllers.</li>
<li>The actual ABI doesn’t have error management at all, but that shouldn’t be hard to implement: the serialized ABI data structures might be enums with error as one of the variants, so then the error is propagated back to the user as a <code>Result</code>.</li>
</ul>
<h2 id="Wait-where-is-Golang">Wait, where is Golang?</h2>
<p>Our <em>dream</em> is to port existing controllers to this approach. Most of Kubernetes world today lives in Golang, but up until this point I didn’t talk at all about Golang. Why?</p>
<p>The reason is that we found some critical issues within the Wasm/Golang support, among the others Golang assumes that the Wasm engine runs inside a JS VM using <a target="_blank" rel="noopener" href="https://github.com/golang/go/blob/master/misc/wasm/wasm_exec.js">wasm_exec.js</a>. In order to understand the impact of this choice, let me go through the Golang standard library implementation in Wasm.</p>
<p>Today in Golang, when you compile to Wasm, all the standard library I/O operations go through the <a target="_blank" rel="noopener" href="https://golang.org/pkg/syscall/js/"><code>syscall/js</code> module</a>, which invokes a predefined set of imports in your module. From the doc: <em>Package js gives access to the WebAssembly host environment when using the js/wasm architecture. Its API is based on JavaScript semantics.</em>:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://golang.org/pkg/syscall/js/#Global"><code>Global()</code></a> allows you to get the <code>global</code> object</li>
<li><a target="_blank" rel="noopener" href="https://golang.org/pkg/syscall/js/#Value.Invoke"><code>Invoke()</code></a> allows you to use a <code>js.Value</code> as a function and invoke it</li>
</ul>
<p>Now let’s analyze how the <code>net/http</code> client implementation on Wasm: When the user invokes <code>RoundTrip</code>, the request <a target="_blank" rel="noopener" href="https://github.com/golang/go/blob/b56791cdea5caa87ffcd585d29c294bd3d08a06a/src/net/http/roundtrip_js.go#L60">is transformed in a Javascript object</a>, then using the syscall <code>Global</code> and <code>Call</code> the javascript global function <a target="_blank" rel="noopener" href="https://github.com/golang/go/blob/b56791cdea5caa87ffcd585d29c294bd3d08a06a/src/net/http/roundtrip_js.go#L106"><code>fetch</code> is invoked</a> and finally, on the returned promise, the <a target="_blank" rel="noopener" href="https://github.com/golang/go/blob/b56791cdea5caa87ffcd585d29c294bd3d08a06a/src/net/http/roundtrip_js.go#L167">two callbacks are set</a> to handle response and error.</p>
<p>The problem with this approach, although it works well in the browsers, is that the <strong>engine needs to implement all these JS functions used by Golang standard library</strong>. If we’re not using a Javascript based runtime, we need to reimplement this. Further, it requires us to <strong>secure access</strong> to the <em>global</em> object fields, in order to retain the isolation properties.</p>
<p>To make things even worse, at the moment there is no way to define imports and exports within the module, so we cannot define and evolve an ABI that fits our needs. The only workable solution with the existing tools consists in define “fake” Javascript functions on the host side for the imports and setting “fake” fields on the <a target="_blank" rel="noopener" href="https://github.com/golang/go/issues/25612#issuecomment-506307400">“fake” global object for the exports</a>, but this approach makes the code far more complex and convoluted, both on host and Wasm module side.</p>
<div class="note info"><p>While the official Golang distribution <a target="_blank" rel="noopener" href="https://github.com/golang/go/issues/25612">doesn’t support</a> definining imports and exports, <a target="_blank" rel="noopener" href="https://github.com/tinygo-org/tinygo/tree/master/src/examples/wasm">TinyGo supports it</a></p>
</div>
<p>Markus managed to run the Memcached operator example of operator-sdk, using NodeJS as a host, hacking some polyfills to match the expectations of <a target="_blank" rel="noopener" href="https://github.com/golang/go/blob/master/misc/wasm/wasm_exec.js">wasm_exec.js</a>. The final module ABI is:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">% </span><span class="language-bash">wasm-nm test.wasm -i</span></span><br><span class="line">i debug</span><br><span class="line">i runtime.resetMemoryDataView</span><br><span class="line">i runtime.wasmExit</span><br><span class="line">i runtime.wasmWrite</span><br><span class="line">i runtime.nanotime1</span><br><span class="line">i runtime.walltime1</span><br><span class="line">i runtime.scheduleTimeoutEvent</span><br><span class="line">i runtime.clearTimeoutEvent</span><br><span class="line">i runtime.getRandomData</span><br><span class="line">i syscall/js.finalizeRef</span><br><span class="line">i syscall/js.stringVal</span><br><span class="line">i syscall/js.valueGet</span><br><span class="line">i syscall/js.valueSet</span><br><span class="line">i syscall/js.valueIndex</span><br><span class="line">i syscall/js.valueSetIndex</span><br><span class="line">i syscall/js.valueCall</span><br><span class="line">i syscall/js.valueNew</span><br><span class="line">i syscall/js.valueLength</span><br><span class="line">i syscall/js.valuePrepareString</span><br><span class="line">i syscall/js.valueLoadString</span><br><span class="line">i syscall/js.copyBytesToGo</span><br><span class="line">i syscall/js.copyBytesToJS</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">% </span><span class="language-bash">wasm-nm test.wasm -e</span></span><br><span class="line">e run</span><br><span class="line">e resume</span><br><span class="line">e getsp</span><br></pre></td></tr></table></figure>
<p>I was initially puzzled by the <code>resume</code> and <code>getsp</code> exports of the Wasm module, but then digging in the <a target="_blank" rel="noopener" href="https://github.com/golang/go/blob/master/misc/wasm/wasm_exec.js">wasm_exec.js</a> codebase their existence was justified: using <code>resume</code> and <code>getsp</code> the host can yield the execution of the module, perform some async operations, and then resume the execution of the code. That’s the very same solution I would love to implement in our Rust ABI prototype and, as far as I know, <a target="_blank" rel="noopener" href="https://github.com/WebAssembly/WASI/issues/276">WASI is looking for a generalized solution to support async runtimes inside the modules</a>.</p>
<p>This experiment proves that Golang/Wasm support can definitely work and we think that, without the constraints of <code>syscall/js</code> and with the ability to define our ABI, we could port all the existing controllers to compile in Wasm isolated modules.</p>
<div class="note info"><p>Some interesting issues to follow about Golang and Wasm related to this discussion:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/golang/go/issues/31105">Golang + WASI</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/tinygo-org/tinygo/issues/1189">Ability to reduce js-centricness of compiled wasm modules in TinyGo</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/golang/go/issues/27766">Make syscall/js optional when compiling wasm</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/golang/go/issues/25612">re-use //export mechanism for exporting identifiers within wasm modules</a></li>
</ul>
</div>
<h2 id="There-is-still-a-long-road-ahead">There is still a long road ahead</h2>
<p>Our long-term goal is to improve the Kubernetes ecosystem, creating a production ready plugin system with low footprint. We encourage the Kubernetes community to give us feedback on our findings and our prototype, so we can work together on shaping the future of Kubernetes controllers!</p>
<p>Check out the second part of this blog post series: <a href="../Kubernetes-controllers-The-Empire-Strikes-Back">Kubernetes controllers: The Empire Strikes Back</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/cloud/" rel="tag"># cloud</a>
              <a href="/tags/kubernetes/" rel="tag"># kubernetes</a>
              <a href="/tags/rust/" rel="tag"># rust</a>
              <a href="/tags/webassembly/" rel="tag"># webassembly</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/Reproducibility-of-benchmarks-in-Kubernetes/" rel="prev" title="Reproducibility of benchmarks in Kubernetes">
                  <i class="fa fa-chevron-left"></i> Reproducibility of benchmarks in Kubernetes
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/Vert-x-Container-images-with-jlink/" rel="next" title="Vert.x container images with jlink">
                  Vert.x container images with jlink <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Software Engineer</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdn.jsdelivr.net/npm/mermaid@8.13.10/dist/mermaid.min.js","integrity":"sha256-CmZCFVnvol9YL23PfjDflGY5nJwE+Mf/JN+8v+tD/34="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>

  <script src="/js/third-party/fancybox.js"></script>


  





</body>
</html>
